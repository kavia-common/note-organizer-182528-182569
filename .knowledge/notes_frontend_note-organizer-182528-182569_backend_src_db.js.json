{"is_source_file": true, "format": "JavaScript", "description": "This file manages the database connection and schema initialization for a note organizer application. It sets up a singleton instance of a SQLite database, ensures the database file and its directory exist, and defines schema creation and migration logic for a 'notes' table, including indexes for efficient querying.", "external_files": ["better-sqlite3", "fs", "path", "dotenv", "url"], "external_methods": ["Database (from 'better-sqlite3')", "fs.existsSync", "fs.mkdirSync", "path.resolve", "path.dirname", "process.env.DB_PATH", "path.join", "fileURLToPath", "db.exec", "db.prepare"], "published": ["getDb"], "classes": [], "methods": [{"name": "getDb()", "description": "Returns a singleton database instance, initializing the database file and schema if not already created.", "scope": "", "scopeKind": ""}, {"name": "initializeSchema(db)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["new Database", "fs.existsSync", "fs.mkdirSync", "path.resolve", "initializeSchema", "db.exec", "db.prepare"], "search-terms": ["singleton database connection", "notes table schema", "SQLite schema initialization", "database migration", "better-sqlite3 initialization"], "state": 2, "file_id": 23, "knowledge_revision": 54, "git_revision": "5b6280ad8bff050b7e034de9dbea8747b623c957", "revision_history": [{"51": ""}, {"54": "5b6280ad8bff050b7e034de9dbea8747b623c957"}], "ctags": [{"_type": "tag", "name": "DB_PATH", "path": "/home/kavia/workspace/code-generation/note-organizer-182528-182569/notes_frontend/note-organizer-182528-182569/backend/src/db.js", "pattern": "/^const DB_PATH = process.env.DB_PATH ? path.resolve(backendRoot, process.env.DB_PATH) : DEFAULT_D/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "DEFAULT_DB_PATH", "path": "/home/kavia/workspace/code-generation/note-organizer-182528-182569/notes_frontend/note-organizer-182528-182569/backend/src/db.js", "pattern": "/^const DEFAULT_DB_PATH = path.join(backendRoot, 'data', 'notes.db');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "__dirname", "path": "/home/kavia/workspace/code-generation/note-organizer-182528-182569/notes_frontend/note-organizer-182528-182569/backend/src/db.js", "pattern": "/^const __dirname = path.dirname(__filename);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "__filename", "path": "/home/kavia/workspace/code-generation/note-organizer-182528-182569/notes_frontend/note-organizer-182528-182569/backend/src/db.js", "pattern": "/^const __filename = fileURLToPath(import.meta.url);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "backendRoot", "path": "/home/kavia/workspace/code-generation/note-organizer-182528-182569/notes_frontend/note-organizer-182528-182569/backend/src/db.js", "pattern": "/^const backendRoot = path.resolve(__dirname, '..');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "dataDir", "path": "/home/kavia/workspace/code-generation/note-organizer-182528-182569/notes_frontend/note-organizer-182528-182569/backend/src/db.js", "pattern": "/^const dataDir = path.dirname(DB_PATH);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "dbInstance", "path": "/home/kavia/workspace/code-generation/note-organizer-182528-182569/notes_frontend/note-organizer-182528-182569/backend/src/db.js", "pattern": "/^let dbInstance = null;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "getDb", "path": "/home/kavia/workspace/code-generation/note-organizer-182528-182569/notes_frontend/note-organizer-182528-182569/backend/src/db.js", "pattern": "/^export function getDb() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "initializeSchema", "path": "/home/kavia/workspace/code-generation/note-organizer-182528-182569/notes_frontend/note-organizer-182528-182569/backend/src/db.js", "pattern": "/^function initializeSchema(db) {$/", "language": "JavaScript", "kind": "function", "signature": "(db)"}], "hash": "edba5c570fe1c9b89df966e7a7a9628b", "format-version": 4, "code-base-name": "notes_frontend", "filename": "notes_frontend/note-organizer-182528-182569/backend/src/db.js", "fields": [{"name": "let dbInstance = null;", "scope": "", "scopeKind": "", "description": "unavailable"}]}